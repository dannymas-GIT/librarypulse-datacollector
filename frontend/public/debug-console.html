<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug Console</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
      background-color: #f5f7fa;
    }
    h1 {
      color: #1e3a8a;
      border-bottom: 2px solid #3b82f6;
      padding-bottom: 10px;
    }
    .console-log {
      background-color: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      max-height: 300px;
      overflow-y: auto;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .log-entry {
      margin-bottom: 8px;
      padding: 8px;
      border-radius: 4px;
    }
    .log-entry.error {
      background-color: #fee2e2;
      border-left: 4px solid #ef4444;
    }
    .log-entry.warning {
      background-color: #fef3c7;
      border-left: 4px solid #f59e0b;
    }
    .log-entry.info {
      background-color: #e0f2fe;
      border-left: 4px solid #3b82f6;
    }
    .actions {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    button {
      background-color: #3b82f6;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
    }
    button:hover {
      background-color: #2563eb;
    }
    .network-test {
      margin-top: 30px;
    }
    .test-result {
      margin-top: 10px;
      padding: 10px;
      background-color: #f3f4f6;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>Debug Console</h1>
  
  <div class="actions">
    <button id="clearBtn">Clear Console</button>
    <button id="testMainBtn">Test Main App</button>
    <button id="testApiBtn">Test API</button>
  </div>
  
  <h2>Console Output</h2>
  <div id="consoleLog" class="console-log"></div>
  
  <div class="network-test">
    <h2>Network Tests</h2>
    <div id="networkResults" class="test-result">Run tests to see results</div>
  </div>
  
  <script>
    // Capture console logs
    const consoleLogDiv = document.getElementById('consoleLog');
    const networkResults = document.getElementById('networkResults');
    
    // Store original console methods
    const originalConsole = {
      log: console.log,
      error: console.error,
      warn: console.warn,
      info: console.info
    };
    
    // Override console methods
    console.log = function(...args) {
      addLogEntry('info', args);
      originalConsole.log.apply(console, args);
    };
    
    console.error = function(...args) {
      addLogEntry('error', args);
      originalConsole.error.apply(console, args);
    };
    
    console.warn = function(...args) {
      addLogEntry('warning', args);
      originalConsole.warn.apply(console, args);
    };
    
    console.info = function(...args) {
      addLogEntry('info', args);
      originalConsole.info.apply(console, args);
    };
    
    function addLogEntry(type, args) {
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      
      const content = args.map(arg => {
        if (typeof arg === 'object') {
          return JSON.stringify(arg, null, 2);
        }
        return String(arg);
      }).join(' ');
      
      entry.textContent = `[${type.toUpperCase()}] ${content}`;
      consoleLogDiv.appendChild(entry);
      consoleLogDiv.scrollTop = consoleLogDiv.scrollHeight;
    }
    
    // Clear console button
    document.getElementById('clearBtn').addEventListener('click', () => {
      consoleLogDiv.innerHTML = '';
    });
    
    // Test main app
    document.getElementById('testMainBtn').addEventListener('click', async () => {
      try {
        networkResults.innerHTML = 'Testing main app...';
        const response = await fetch('/');
        const status = response.status;
        const text = await response.text();
        const hasRoot = text.includes('<div id="root"></div>');
        
        networkResults.innerHTML = `
          <p>Main app response: ${status}</p>
          <p>Contains root div: ${hasRoot}</p>
          <p>Content length: ${text.length} bytes</p>
        `;
        
        console.info(`Main app test: Status ${status}, Root div: ${hasRoot}`);
      } catch (error) {
        networkResults.innerHTML = `Error testing main app: ${error.message}`;
        console.error('Main app test error:', error);
      }
    });
    
    // Test API
    document.getElementById('testApiBtn').addEventListener('click', async () => {
      try {
        networkResults.innerHTML = 'Testing API...';
        const response = await fetch('http://localhost:8000/api/historical/summary');
        const status = response.status;
        const data = await response.json();
        
        networkResults.innerHTML = `
          <p>API response: ${status}</p>
          <p>Data received: ${JSON.stringify(data, null, 2)}</p>
        `;
        
        console.info(`API test: Status ${status}, Data:`, data);
      } catch (error) {
        networkResults.innerHTML = `Error testing API: ${error.message}`;
        console.error('API test error:', error);
      }
    });
    
    // Log initial page load
    console.info('Debug console loaded at', new Date().toLocaleString());
    
    // Test for CORS issues
    fetch('http://localhost:8000/api/historical/summary')
      .then(response => response.json())
      .then(data => {
        console.info('API connection test successful:', data);
      })
      .catch(error => {
        console.error('API connection test failed:', error);
      });
  </script>
</body>
</html> 